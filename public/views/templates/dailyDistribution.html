<div ng-hide="ddc.gotData" class="ng-hide">
<div id="loader"></div>
</div>

<div class="container" ng-show="ddc.gotData">
<h2>Daily Distribution</h2>

<div class="form-group col-sm-4">
  <label>Start Date:</label>
  <input class = "form-control" type="date" ng-model="startDate"></input>
</div>
<div class="form-group col-sm-4">
  <label>End Date:</label>
  <input class = "form-control" type="date" ng-model="endDate"></input>
</div>

<div class="form-group col-sm-4">
  <label>Search:</label>
  <input class="form-control" type="search" ng-model="ddc.search">
</div>
</form>

<table wt-responsive-table class="table">
  <div>
  <thead class="testtesttest">
    <tr>
      <th>First Name</th>
      <th>Last Name Initals</th>
      <!-- Switch to Angular Repeat from Category Factory -->
      <th ng-repeat="category in ddc.categories.list  | filter: {daily_dist: true}">{{category.name}}</th>
      <!-- End Angular Category Repeat -->
      <th>Time Weighed</th>
      <th>Date Weighed</th>
      <th></th>
    </tr>
  </thead>
    <div class="testtesttest">
    <tbody>
      <!-- Add Distribution -->
      <tr class="testtesttest">
        <td>
          <input class="form-control" type="text" ng-model="ddc.newDistribution.first_name">
        </td>
        <td>
            <input class="form-control" type="text" ng-model="ddc.newDistribution.last_name">
        </td>
        <td ng-repeat="category in ddc.categories.list  | filter: {daily_dist: true}">
          <input class="form-control" type= "number" ng-model="ddc.newDistribution.categories[category.id]"></input>
        </td>
        <td><input class="form-control" ng-model="ddc.newDistribution.time_weighted"></td>
        <td><input class="form-control" type="date" ng-model="ddc.newDistribution.date_weighted"></td>
        <td>
          <button
            type="button"
            class="btn btn-success"
            ng-click="ddc.addDistribution()">
            <add-glyph boolean="ddc.newDistribution.saving"></add-glyph>
          </button>
        </td>
      </tr>

      <tr ng-repeat="distribution in ddc.dailyDistributions.list
      | filter: ddc.search
      | dateRange:startDate:endDate">
        <!-- First Name -->
        <td>
          <span class="form-control" disabled ng-if="!distribution.editable">{{distribution.first_name}}</span>
          <span ng-if="distribution.editable">
            <input class="form-control" type="text" ng-model="distribution.first_name">
          </span>
        </td>
        <!-- Last Name -->
        <td>
          <span class="form-control" disabled ng-if="!distribution.editable">{{distribution.last_name}}</span>
          <span ng-if="distribution.editable">
            <input class="form-control" type="text" ng-model="distribution.last_name">
          </span>
        </td>
        <!-- Categories -->
        <td ng-repeat="category in ddc.categories.list  | filter: {daily_dist: true}">
          <span class="form-control" disabled ng-if="!distribution.editable">{{distribution.categories[category.id]}}</span>
          <span ng-if="distribution.editable">
            <input class="form-control" type="text" ng-model="distribution.categories[category.id]">
          </span>
        </td>
        <!-- Time Weighed -->
        <td>
          <span class="form-control" disabled ng-if="!distribution.editable">{{distribution.time_weighed}}</span>
          <span ng-if="distribution.editable">
            <input class="form-control" type="date" ng-model="distribution.time_weighed">
          </span>
        </td>
        <!-- Date Weighed -->
        <td>
          <span class="form-control"
          disabled ng-if="!distribution.editable">{{distribution.date_added}}</span>
          <span ng-if="distribution.editable">
            <input class="form-control"
            type="date" value="{{distribution.timestamp | date 'MM/dd/yyyy'}}"
            ng-model="distribution.date_added" required>
          </span>
        </td>
        <!-- Edit -->
        <td>
          <!-- Not editable -->
          <span ng-if="!distribution.editable">
            <button
                type="button"
                class="btn btn-primary"
                ng-click="ddc.toggleEditable(distribution)">
              <span class="glyphicon glyphicon-pencil"></span> Edit
            </button>
            <button
              type="button"
              class="btn btn-danger"
              ng-click="ddc.deleteDistribution(distribution)">
              <!-- <span class="glyphicon glyphicon-trash"></span> Delete -->
              <delete-glyph boolean="distribution.saving"></delete-glyph>
            </button>
          </span>
          <!-- Editable -->
          <span ng-if="distribution.editable">
            <button
                type="button"
                class="btn btn-primary"
                ng-click="ddc.updateDistribution(distribution)">
              <save-glyph boolean="distribution.saving"></save-glyph>
            </button>
            <button
                type="button"
                class="btn btn-default"
                ng-click="ddc.toggleEditable(distribution)">
              <span class="glyphicon glyphicon-remove"></span> Cancel
            </button>
          </span>
        </td>
      </tr>
    </tbody>
  </table>
</div>
</div>
</div>
